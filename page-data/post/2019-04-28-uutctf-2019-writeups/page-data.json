{"componentChunkName":"component---src-templates-blog-post-js","path":"/post/2019-04-28-uutctf-2019-writeups","result":{"data":{"markdownRemark":{"id":"933d5e22-a6a1-56b3-a0c4-9fc1f1a2a0fb","html":"<h4>Challenges:</h4>\n<ul>\n<li>\n<p>Web</p>\n<ul>\n<li>Bad JS</li>\n<li>Old CTF</li>\n</ul>\n</li>\n<li>\n<p>Misc</p>\n<ul>\n<li>The Trouble Maker</li>\n</ul>\n</li>\n<li>\n<p>Forensics</p>\n<ul>\n<li>Now You See Me #1</li>\n</ul>\n</li>\n</ul>\n<h1>Web</h1>\n<h2>Bad JS</h2>\n<h3>Web - 100 points (solved)</h3>\n<blockquote>\n<p>There is a bad JS which hides flag inside. Capture it.</p>\n</blockquote>\n<hr>\n<h2>Solution</h2>\n<p>We are given a html and javascript file that make up a simple flag checking page. The javascript is obfuscated so we can't easily work through it by hand to retrieve the flag. Instead, we open the index.html file in Chrome or Firefox and use the browser's debugger tool to view variable values. Checking through the values after a short while, we find the flag.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 236px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/portfolio/static/eba9383b11be7d4d94c7fea4618dcbc9/a7bcd/badjs-flag.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAABL0lEQVQoz4WRC0/CQBCE+f+/yUSNAYyEV8vDSCsUC22xPFpA7O3ejnetgImJTjK5zd3ul7m7mojAarVn1GcK/oahdim0cw/yHLDngkaPxk+g1g1o0AD7Dsipgzq3oP4DyG2AeqZ/1ETtDIwzRjtUGMcKwZbAqxA6moGDZ3DoQY455GMPOWSQ4mTqA+R0rPbsWp7nV+Byx+guFAYRwV8TVBpBT4fg2Rg6XZY9wgzbLVpDROOsn/UFGGUVsPWmMDdwLD3QpFcB1xF43AK178AvXfDUBU/6lcMJdBx8g+UKTHLGKCGTUOF1K+DsHdrA2ELtlYuiHBBSVUJrm1hzWf8CpuWnFGXCafoJ3ibV47tNk2CO/3TmXIBz87uNoEAnJGx2OeD3oIYGtlpcBv6ylVIKX1HoF5RcMIPSAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"badjs flag\" title=\"badjs flag\" src=\"/portfolio/static/eba9383b11be7d4d94c7fea4618dcbc9/a7bcd/badjs-flag.png\" srcset=\"/portfolio/static/eba9383b11be7d4d94c7fea4618dcbc9/8a4e8/badjs-flag.png 150w,\n/portfolio/static/eba9383b11be7d4d94c7fea4618dcbc9/a7bcd/badjs-flag.png 236w\" sizes=\"(max-width: 236px) 100vw, 236px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\">\n  </a>\n    </span>\n<p>Performing the hashing, we get the flag: <code>UUTCTF{f528764d624db129b32c21fbca0cb8d6}</code></p>\n<hr>\n<h2>Old CTF</h2>\n<h3>Web - 212 points (solved)</h3>\n<blockquote>\n<p>There is an old page of UUTCTF at:</p>\n<p><a href=\"http://188.40.189.2:8004/\">http://188.40.189.2:8004/</a></p>\n<p>Simple, find the flag.</p>\n</blockquote>\n<hr>\n<h2>Solution</h2>\n<p>The URL links to a local version of the ctftime wtf-ctf page. All links on the page link to the real ctftime page. Checking source code and cookies don't reveal anything interesting either. Checking <code>robots.txt</code>, we see that the page has a <code>login.php</code> page. The <code>login.php</code> page has a member login form. Assuming the website is using SQL, we try the standing SQL injection attack, entering in <code>' or 1=1 or username='</code> for the username field and <code>' or 1=1 or password='</code> for the password field. We get the message:</p>\n<blockquote>\n<p>Sorry, You must be admin to find the flag! Are you tired? Eat some cookies ;) </p>\n</blockquote>\n<p>This prompts us to check our cookies and we find a cookie named <code>AdminToken</code> with some hash. If we look at the request that is being sent when we try to login, we see there is a <code>token</code> field that is also being sent which is different to the <code>AdminToken</code> cookie. Sending the form with the initial query and the new <code>AdminToken</code> gives us the flag: <code>1f29322531f03627428a73f70664c8e9</code></p>\n<hr>\n<h1>Misc</h1>\n<h2>The Trouble Maker</h2>\n<h3>Misc - 220 points (solved)</h3>\n<blockquote>\n<p>Linus Torvalds is a trouble maker! He made a web page which hides the flag. Find and capture it!</p>\n<p>Webpage is at: <a href=\"http://188.40.189.2:8001\">http://188.40.189.2:8001</a></p>\n</blockquote>\n<hr>\n<h2>Solution</h2>\n<p>The website is a single page that says:</p>\n<blockquote>\n<p>Linus has made awesome tools!\nWhy don't you use them?!</p>\n</blockquote>\n<p>So our first instinct would be to check for a <code>.git</code> folder. Sure enough, it's there. Dumping it using <a href=\"https://github.com/internetwache/GitTools/blob/master/Dumper/gitdumper.sh\">gitdumper.sh</a> and checking the commit log, we get the following:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> <span class=\"token function\">git</span> log\n\ncommit 89df7cb11d670308abe21dc7dd82294360fde129 <span class=\"token punctuation\">(</span>HEAD -<span class=\"token operator\">></span> master<span class=\"token punctuation\">)</span>\nAuthor: Linus <span class=\"token operator\">&lt;</span>linus@ctf.uut.ac.ir<span class=\"token operator\">></span>\nDate:   Fri Apr <span class=\"token number\">26</span> <span class=\"token number\">14</span>:37:39 <span class=\"token number\">2019</span> +0430\n\n    this still needs purging<span class=\"token operator\">!</span>\n\ncommit 24ad3f97738d5669e171ea4c3f280c62797dd21d\nAuthor: Linus <span class=\"token operator\">&lt;</span>linus@ctf.uut.ac.ir<span class=\"token operator\">></span>\nDate:   Fri Apr <span class=\"token number\">26</span> <span class=\"token number\">14</span>:23:12 <span class=\"token number\">2019</span> +0430\n\n    this may <span class=\"token builtin class-name\">help</span>\n\ncommit a0e95d9e42265faa38c5caa10965d6e2c5f1e47b\nAuthor: Linus <span class=\"token operator\">&lt;</span>linus@ctf.uut.ac.ir<span class=\"token operator\">></span>\nDate:   Sun Apr <span class=\"token number\">14</span> 01:24:53 <span class=\"token number\">2019</span> +0430\n\n    editting views<span class=\"token operator\">!</span>\n\ncommit 6be73c9495f15c7379f362f7017eb1d5d23ea62a\nAuthor: Linus <span class=\"token operator\">&lt;</span>linus@ctf.uut.ac.ir<span class=\"token operator\">></span>\nDate:   Sun Apr <span class=\"token number\">14</span> 01:19:14 <span class=\"token number\">2019</span> +0430\n\n    purging some file<span class=\"token operator\">!</span>\n\n<span class=\"token punctuation\">..</span>.</code></pre></div>\n<p>Looking at the difference between the commit with the <code>this may help</code> message, we see:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> <span class=\"token function\">git</span> <span class=\"token function\">diff</span> 24ad3f\n\n<span class=\"token function\">diff</span> --git a/resources/js/front.js b/resources/js/front.js\ndeleted <span class=\"token function\">file</span> mode <span class=\"token number\">100644</span>\nindex d157bbd<span class=\"token punctuation\">..</span>0000000\n--- a/resources/js/front.js\n+++ /dev/null\n@@ -1 +0,0 @@\n-var string <span class=\"token operator\">=</span> <span class=\"token string\">\"RmxhZyBpczogVVVUQ1RGe1ZWZV8gfF8wVmVfTCFuKF8pJH0=\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Base64 decoding the string variable:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'RmxhZyBpczogVVVUQ1RGe1ZWZV8gfF8wVmVfTCFuKF8pJH0='</span> <span class=\"token operator\">|</span> base64 -d\nFlag is: UUTCTF<span class=\"token punctuation\">{</span>VVe_ <span class=\"token operator\">|</span>_0Ve_L<span class=\"token operator\">!</span>n<span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">)</span>$<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>\n<h1>Forensics</h1>\n<h2>Now You See Me #1</h2>\n<h3>Forensics - 200 points (solved)</h3>\n<blockquote>\n<p>Find the flag inside the BMP.</p>\n</blockquote>\n<hr>\n<h2>Solution</h2>\n<p>Opening the image in stegsolve doesn't give us any good results. As is usual for stego challenges, we try lsb. Our bitmap image is made up of bytes (8 bits) that represent the red, green and blue 'amounts' in each pixel. Using the 8th bit of each point to transmit hidden messages is a common steganography technique as the change is so insignificant that the human eye will barely notice any difference. This is exemplified in the follow image from wikipedia (although this image modifies the last two bits):</p>\n<p><img src=\"https://upload.wikimedia.org/wikipedia/commons/0/0c/LeastSignificantBitDemonstration.jpg\" alt=\"https://upload.wikimedia.org/wikipedia/commons/0/0c/LeastSignificantBitDemonstration.jpg\"></p>\n<p>So if we assume a message is stored using the last bit in each byte of the image file, we can write a script to extract the data. We should be careful though. The following script won't find the flag for us:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> binascii <span class=\"token keyword\">import</span> unhexlify\nimage <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'LAND2.BMP'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nlsbs <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> image<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nflag <span class=\"token operator\">=</span> unhexlify<span class=\"token punctuation\">(</span><span class=\"token string\">'%x'</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>lsbs<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token string\">'uutctf'</span> <span class=\"token keyword\">in</span> flag<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span> flag<span class=\"token punctuation\">[</span>flag<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'uutctf'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>flag<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'}'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>This is because when hiding messages in the least significant bits, there needs to be a way of telling when the message has ended. This is done by making all the least significant bits after the message has ended a 0. However, our script will add that 0 on to our <code>lsbs</code> string which is essentially a left shift and completely changes the 'message'. To figure out where the message ends, we have to look from the last byte of the bmp file and search backwards, finding where the last bit stops being 0. We can use <code>xxd</code> to help us with this:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> xxd LAND2.BMP <span class=\"token operator\">|</span> <span class=\"token function\">tail</span>\n\n000c03a0: cccc cccc cccc cccc cccc cccc cccc cccc  <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>\n000c03b0: cccc cccc cccc cccc cccc cccc cccc cccc  <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>\n000c03c0: cccc cccc cccc cccc cccc cccc cccc cccc  <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>\n000c03d0: cccc cccc cccc cccc cccc cccc cccc cccc  <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>\n000c03e0: cccc cccc cccc cccc cccc cccc cccc cccc  <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>\n000c03f0: cccc cccc cccc cccc cccc cccc cccc cccc  <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>\n000c0400: cccc cccc cccc cccc cccc cccc cccc cccc  <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>\n000c0410: cccc cccc ccd0 ccd0 ccd0 ccd0 ccd0 ccd0  <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>\n000c0420: ccd0 ccd0 ccd0 ccee ccd0 d0d0 ccd0 ccd0  <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>\n000c0430: ccd0 ccd0 ccd0                           <span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span></code></pre></div>\n<p>Counting from <code>ccd0</code> (inclusive) to <code>ccee</code> (exclusive), we get a total of 7 bytes. We could edit the bmp and remove these bytes manually, or we could just modify our script:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> binascii <span class=\"token keyword\">import</span> unhexlify\nimage <span class=\"token operator\">=</span> <span class=\"token builtin\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">'LAND2.BMP'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'rb'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>read<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nlsbs <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token builtin\">str</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">ord</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token operator\">&amp;</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> c <span class=\"token keyword\">in</span> image<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token operator\">-</span><span class=\"token number\">7</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nflag <span class=\"token operator\">=</span> unhexlify<span class=\"token punctuation\">(</span><span class=\"token string\">'%x'</span> <span class=\"token operator\">%</span> <span class=\"token builtin\">int</span><span class=\"token punctuation\">(</span>lsbs<span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">if</span> <span class=\"token string\">'uutctf'</span> <span class=\"token keyword\">in</span> flag<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">print</span> flag<span class=\"token punctuation\">[</span>flag<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'uutctf'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>flag<span class=\"token punctuation\">.</span>find<span class=\"token punctuation\">(</span><span class=\"token string\">'}'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>Running our script (python2):</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">></span> python2 ./solve.py\nuutctf<span class=\"token punctuation\">{</span>good_for_you<span class=\"token punctuation\">}</span></code></pre></div>\n<hr>","frontmatter":{"date":"April 28, 2019","path":"/post/2019-04-28-uutctf-2019-writeups","title":"UUTCTF 2019 Writeups","tags":"ctf,infosec,writeup,web,misc,forensics"}}},"pageContext":{"prev":{"fileAbsolutePath":"/media/winarch-shared/code/portfolio/src/posts/2019-06-27-first-semester-at-unimelb/index.md","frontmatter":{"title":"First Semester at Unimelb","path":"/post/2019-06-27-first-sem-at-unimelb"}},"next":{"fileAbsolutePath":"/media/winarch-shared/code/portfolio/src/posts/2019-04-23-angstromctf-2019-writeups/index.md","frontmatter":{"title":"AngstromCTF 2019 Writeups","path":"/post/2019-04-23-angstromctf-2019-writeups"}}}}}