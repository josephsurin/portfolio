{"componentChunkName":"component---src-templates-blog-post-js","path":"/post/2020-02-19-tshark-cheatsheet","result":{"data":{"markdownRemark":{"id":"1491a8d9-9faf-568f-9db6-56f083d15957","html":"<h2>BASICS</h2>\n<p>Read from a pcap: <code>tshark -r &#x3C;file.pcap></code></p>\n<p>Print TCP conversations: <code>tshark -r &#x3C;file.pcap> -z conv,tcp</code> (add <code>-q</code> to suppress packet info)</p>\n<p>Print field-formatted: <code>tshark -r &#x3C;file.pcap> -T fields -e &#x3C;field1> -e &#x3C;field2> ...</code></p>\n<p>List User-Agents: <code>tshark -r &#x3C;file.pcap> -T fields -e http.user_agent</code></p>\n<p>Print X.509 certs: <code>tshark -r &#x3C;file.pcap> -T fields -R \"ssl.handshake.certificate\" -e x509sat.printableString</code></p>\n<p>Apply a display filter: <code>tshark -r &#x3C;file.pcap> -Y &#x3C;display filter></code></p>\n<p>Print packet summaries for TCP packets to port 71: <code>tshark -r &#x3C;file.pcap> -Y \"tcp.dstport == 71\"</code></p>\n<p>Display contents of TCP stream between 10.0.0.1 port 123 and 10.0.0.2 port 456: <code>tshark -r &#x3C;file.pcap> -z \"follow,tcp,ascii,10.0.0.1:123,10.0.0.2:456\"</code></p>\n<p>Decrypt WPA traffic (<code>-o &#x3C;pref>:&#x3C;val></code> overrides preference) and print http file data: <code>tshark -r &#x3C;file.pcap> -o wlan.enable_decryption:TRUE -o \"uat:80211_keys:\\\"wpa-pwd\\\",\\\"password:&#x3C;w1F1-P4ssw0rD\\\"\" -T fields -e http.file_data</code></p>\n<p>Decrypt using SSL keys: <code>tshark -r &#x3C;file.pcap> -o 'uat:rsa_keys:\"./server_private_key.pem\",\"\"' -Tfields -e text</code></p>\n<p>Decrypt with pre master secret: <code>tshark -r &#x3C;file.pcap> -o 'tls.keylog_file:./premastersecret.txt' -T fields -e http.request.uri</code></p>\n<p>Show detailed view of http packets and summaries of others: <code>tshark -r &#x3C;file.pcap> -O http</code></p>\n<p>List possible fields: <code>tshark -G</code></p>\n<h2>Fields Cheatsheet</h2>\n<p>The field <code>text</code> on its own may sometimes work (e.g. for HTTP and FTP)</p>\n<h4>Ethernet <code>eth</code></h4>\n<p><a href=\"https://www.wireshark.org/docs/dfref/e/eth.html\">https://www.wireshark.org/docs/dfref/e/eth.html</a></p>\n<p><code>addr</code>, <code>len</code>, <code>src</code>, <code>dst</code>, <code>lg</code>, <code>trailer</code>, <code>ig</code>, <code>multicast</code>, <code>type</code></p>\n<h4>IPv4 <code>ip</code></h4>\n<p><a href=\"https://www.wireshark.org/docs/dfref/i/ip.html\">https://www.wireshark.org/docs/dfref/i/ip.html</a></p>\n<p><code>addr</code>, <code>checksum</code>, <code>checksum_bad</code>, <code>checksum_good</code>, <code>dst</code>, <code>dst_host</code>, <code>flags</code>, <code>flags.df</code>, <code>flags.mf</code>, <code>flags.rb</code>, <code>hdr_len</code>, <code>host</code>, <code>id</code>, <code>len</code>, <code>proto</code>, <code>reassembled_in</code>, <code>src</code>, <code>src_host</code>, <code>tos</code>, <code>tos.cost</code>, <code>tos.delay</code>, <code>tos.precedence</code>, <code>tos.reliability</code>, <code>tos.throughput</code>, <code>ttl</code>, <code>version</code></p>\n<h4>IPv6 <code>ipv6</code></h4>\n<p><a href=\"https://www.wireshark.org/docs/dfref/i/ipv6.html\">https://www.wireshark.org/docs/dfref/i/ipv6.html</a></p>\n<p><code>addr</code>, <code>dst</code>, <code>dst_host</code>, <code>hlim</code>, <code>host</code>, <code>nxt</code>, <code>opt.pad1</code>, <code>opt.padn</code>, <code>plen</code>, <code>reassembled_in</code>, <code>src</code>, <code>src_host</code>, <code>version</code></p>\n<h4>TCP <code>tcp</code></h4>\n<p><a href=\"https://www.wireshark.org/docs/dfref/t/tcp.html\">https://www.wireshark.org/docs/dfref/t/tcp.html</a></p>\n<p><code>ack</code>, <code>checksum</code>, <code>checksum_bad</code>, <code>checksum_good</code>, <code>continuation_to</code>, <code>dstport</code>, <code>flags</code>, <code>flags.{ack,cwr,ecn,fin,push,reset,syn,urg}</code>, <code>hdr_len</code>, <code>len</code>, <code>nxtseq</code>, <code>options</code>, <code>options.{cc,ccecho,ccnew,echo,echo_reply,md5,mss,mss_val,qs,sack,sack_le.sack_perm,sack_re,time_stamp,wscale,wscale_val}</code>, <code>pdu.{last_frame,size,time}</code>, <code>port</code>, <code>reassembled_in</code>, <code>segment</code>, <code>segment.{error,multipletails,overlap,overlap.conflict,toolongfragment}</code>, <code>segments</code>, <code>seq</code>, <code>srcport</code>, <code>time_delta</code>, <code>time_relative</code>, <code>urgent_pointer</code>, <code>window_size</code>, <code>payload</code></p>\n<h4>UDP <code>udp</code></h4>\n<p><a href=\"https://www.wireshark.org/docs/dfref/u/udp.html\">https://www.wireshark.org/docs/dfref/u/udp.html</a></p>\n<p><code>checksum</code>, <code>checksum_bad</code>, <code>checksum_good</code>, <code>dstport</code>, <code>length</code>, <code>port</code>, <code>srcport</code></p>\n<h4>HTTP <code>http</code></h4>\n<p><a href=\"https://www.wireshark.org/docs/dfref/h/http.html\">https://www.wireshark.org/docs/dfref/h/http.html</a></p>\n<p><code>accept</code>, <code>accept_encoding</code>, <code>accept_language</code>, <code>authbasic</code>, <code>authorization</code>, <code>cache_control</code>, <code>connection</code>, <code>content_encoding</code>, <code>content_length</code>, <code>content_type</code>, <code>cookie</code>, <code>date</code>, <code>file_data</code>, <code>host</code>, <code>last_modified</code>, <code>location</code>, <code>notification</code>, <code>proxy_authenticate</code>, <code>proxy_authorization</code>, <code>proxy_connect_host</code>, <code>proxy_connect_port</code>, <code>referer</code>, <code>request</code>, <code>request.{full_uri,method,uri,version}</code>, <code>request.uri.{path,query,query.parameter}</code>, <code>response</code>, <code>response.{code,code.desc,phrase}</code>, <code>server</code>, <code>set_cookie</code>, <code>transfer_encoding</code>, <code>user_agent</code>, <code>www_authenticate</code>, <code>x_forwarded_for</code></p>\n<h4>SSL <code>ssl</code></h4>\n<p><a href=\"https://www.wireshark.org/docs/dfref/s/ssl.html\">https://www.wireshark.org/docs/dfref/s/ssl.html</a></p>\n<p><code>handshake</code>, <code>handshake.{cert_status,cert_status_len,cert_status_type,cert_type,cert_types,cert_types_count,certificate,certificate_length,challenge,challenge_length,cipher_spec_len,cipher_suites_length,cipherspec,ciphersuiteciphersuites,clear_key_data,clear_key_lengthclient_cert_vrfy.sig,client_cert_crfy.sig_len,client_point,client_point_len,comp_method,comp_methods,comp_methods_length,connection_id,connection_id_length,encrypted_key,encrypted_key_length,epms,epms_len,exponent,exponent_len,extension.data,extension.len,modulus,modulus_len,identity,identity_len,server_point,server_point_len}</code>, <code>handshake.cert_type.{type,types,types_len}</code></p>\n<h4>FTP <code>ftp</code></h4>\n<p>(not prefixed): <code>ftp-data.command</code>, <code>ftp-data.setup-method</code>, <code>ftp-data.current-working-directory</code></p>\n<p><code>active.{cip,nat,port}</code>, <code>command</code></p>","frontmatter":{"date":"February 19, 2020","path":"/post/2020-02-19-tshark-cheatsheet","title":"tshark Cheatsheet","tags":"ctf,infosec,random"}}},"pageContext":{"prev":{"fileAbsolutePath":"/home/joseph/Libraries/Code/portfolio/src/posts/2020-03-12-building-ctf-challenges-with-socat-and-docker/index.md","frontmatter":{"title":"Building CTF Challenges with socat and Docker","path":"/post/2020-03-12-building-ctf-challenges-with-socat-and-docker"}},"next":{"fileAbsolutePath":"/home/joseph/Libraries/Code/portfolio/src/posts/2019-12-16-watevrctf-2019-writeups/index.md","frontmatter":{"title":"watevrCTF 2019 Writeups","path":"/post/2019-12-16-watevrctf-2019-writeups"}}}}}